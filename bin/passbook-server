#!/usr/bin/env node

'use strict';
const fs = require('fs-extra');
const path = require('path');
const pkg = require('../package.json');
const program = require('commander');



require('autocmdr/lib/logger')(program);
require('autocmdr/lib/config')(program);


const userHome = require('user-home');
const config = program.config.get();
config.dataPath = path.resolve(userHome, `./${pkg.name}/${config.dataPath}`);

fs.ensureDirSync(config.dataPath);

var app = require(path.resolve(__dirname, '../src/program'))(config);

program.global = {
  config: config,
  app: app
};

require('autocmdr/lib/loader')(program);

require('autocmdr/lib/completion')(program);
require('autocmdr/lib/package')(program);

require('autocmdr/lib/help')(program);

program
  .parse(process.argv);

if (program.args.length < 1) {
  console.log('No command specified. See \'passbook-server --help\':');
  program.outputHelp();
  process.exit(1);
}
