#!/usr/bin/env node

'use strict';
var program = require('commander');
const userHome = require('user-home');
const path = require('path');

require('autocmdr/lib/logger')(program);
require('autocmdr/lib/config')(program);

const config = program.config.get();
config.dataPath = path.resolve(userHome, config.dataPath);


var serverProgram = require('../src/program')(config);


//console.log(JSON.stringify(config));

//var serverProgram = require('../src/program')(config);

program.global = {
  config: config,
  program: serverProgram,
  db: serverProgram.db
};

require('autocmdr/lib/loader')(program);

require('autocmdr/lib/completion')(program);
require('autocmdr/lib/package')(program);

require('autocmdr/lib/help')(program);

program
  .parse(process.argv);

if (program.args.length < 1) {
  console.log('No command specified. See \'passbook-server --help\':');
  program.outputHelp();
  process.exit(1);
}
